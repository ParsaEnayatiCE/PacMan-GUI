Inspired from some sources and game codes
